import{af as P,q as w,A,V as K,l as N,i as B,at as p,N as Q}from"./quasar-1668579305603.js";import{r as h,a as M,c as T,d as c,w as C,ab as y,x as j,j as S,t as V}from"./@vue-1668579305603.js";import{_ as z}from"./ZIXIAOY-1668579305603.js";import{u as D,i as O}from"./components-1668579305603.js";import{b as U}from"./vue-router-1668579305603.js";import"./package-1668579305603.js";import"./@intlify-1668579305603.js";import"./axios-1668579305603.js";import"./echarts-1668579305603.js";import"./zrender-1668579305603.js";import"./xlsx-1668579305603.js";function W(){const v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";this.encode=function(e){let o="",r,t,u,l,d,f,g,m=0;for(e=i(e);m<e.length;)r=e.charCodeAt(m++),t=e.charCodeAt(m++),u=e.charCodeAt(m++),l=r>>2,d=(r&3)<<4|t>>4,f=(t&15)<<2|u>>6,g=u&63,isNaN(t)?f=g=64:isNaN(u)&&(g=64),o=o+v.charAt(l)+v.charAt(d)+v.charAt(f)+v.charAt(g);return o},this.decode=function(e){let o="",r,t,u,l,d,f,g,m=0;for(e=e.replace(/[^A-Za-z0-9-_]/g,"");m<e.length;)l=v.indexOf(e.charAt(m++)),d=v.indexOf(e.charAt(m++)),f=v.indexOf(e.charAt(m++)),g=v.indexOf(e.charAt(m++)),r=l<<2|d>>4,t=(d&15)<<4|f>>2,u=(f&3)<<6|g,o=o+String.fromCharCode(r),f!==64&&(o=o+String.fromCharCode(t)),g!==64&&(o=o+String.fromCharCode(u));return o=$(o).replaceAll("\0",""),o};const i=function(e){e=e.replace(/\r\n/g,`
`);let o="";for(let r=0;r<e.length;r++){const t=e.charCodeAt(r);t<128?o+=String.fromCharCode(t):t>127&&t<2048?(o+=String.fromCharCode(t>>6|192),o+=String.fromCharCode(t&63|128)):(o+=String.fromCharCode(t>>12|224),o+=String.fromCharCode(t>>6&63|128),o+=String.fromCharCode(t&63|128))}return o},$=function(e){let o="",r,t,u,l=0;for(;l<e.length;)r=e.charCodeAt(l),r<128?(o+=String.fromCharCode(r),l++):r>191&&r<224?(t=e.charCodeAt(l+1),o+=String.fromCharCode((r&31)<<6|t&63),l+=2):(t=e.charCodeAt(l+1),u=e.charCodeAt(l+2),o+=String.fromCharCode((r&15)<<12|(t&63)<<6|u&63),l+=3);return o}}var k=new W;const q={class:"login-cls row justify-center"},L={class:"login-tools row justify-around q-pb-lg"},ee={__name:"Login",setup(v){const i=h({}),$=h(!0),e=h(!1),o=h(!1),r=U(),t=h(0),u=h(null),l=h(null),d=h(null),f=()=>{$.value=!$.value};(()=>{const a=p.get("tenantId")||"fmbb",s=p.get("loginName")||"",n=k.decode(p.get("password")||"");o.value=Boolean(p.get("rememberMe")),i.value={loginName:s,password:n,tenantId:a}})();const m=()=>{o.value?(p.set("tenantId",i.value.tenantId,{expires:30}),p.set("loginName",i.value.loginName,{expires:30}),p.set("password",k.encode(i.value.password),{expires:30}),p.set("rememberMe",String(o.value),{expires:30})):(p.remove("tenantId"),p.remove("loginName"),p.remove("password"),p.remove("rememberMe"))},b=a=>t.value=a.keyCode,I=a=>{if(t.value!==229){if(a==="Tenant"&&!u.value.validate())return u.value.focus();if(a==="Input"&&!d.value.validate())return d.value.focus();if(a==="PWD"&&!l.value.validate())return l.value.focus();if(!u.value.validate())return u.value.focus();if(!d.value.validate())return d.value.focus();if(!l.value.validate())return l.value.focus();l.value.blur(),u.value.blur(),d.value.blur(),e.value=!e.value,m(),D().LoginByName(i.value).then(async s=>{await r.replace("/dashboard/console"),Q.create({position:"top-right",icon:"insert_emoticon",message:`Hi\uFF0C${s.nickName} ${O.t("WelcomeBack")}`,color:"positive"}),e.value=!e.value}).catch(()=>{e.value=!e.value})}};return(a,s)=>(M(),T("div",q,[c(B,{class:"login-box shadow-8 column justify-center q-gutter-y-sm"},{default:C(()=>[c(P,{class:"login-logo text-uppercase",src:z},{error:C(()=>[c(w,{name:"self_improvement"})]),_:1}),c(A,{ref_key:"tenInput",ref:u,modelValue:i.value.tenantId,"onUpdate:modelValue":s[0]||(s[0]=n=>i.value.tenantId=n),loading:e.value,placeholder:`${a.$t("PleaseInput")} ${a.$t("Tenant")}${a.$t("No")}`,readonly:e.value,rules:[n=>n&&n.length>0||`${a.$t("PleaseInput")} ${a.$t("Tenant")}${a.$t("No")}`],dense:"","lazy-rules":"",onKeydown:y(b,["enter"]),onKeyup:s[1]||(s[1]=y(n=>I("Tenant"),["enter"]))},{prepend:C(()=>[c(w,{name:"group"})]),_:1},8,["modelValue","loading","placeholder","readonly","rules","onKeydown"]),c(A,{ref_key:"nameInput",ref:d,modelValue:i.value.loginName,"onUpdate:modelValue":s[2]||(s[2]=n=>i.value.loginName=n),loading:e.value,placeholder:`${a.$t("PleaseInput")} ${a.$t("AccountTip1")}`,readonly:e.value,rules:[n=>n&&n.length>0||`${a.$t("PleaseInput")} ${a.$t("AccountTip1")}`],dense:"","lazy-rules":"",onKeydown:y(b,["enter"]),onKeyup:s[3]||(s[3]=y(n=>I("Input"),["enter"]))},{prepend:C(()=>[c(w,{name:"account_circle"})]),_:1},8,["modelValue","loading","placeholder","readonly","rules","onKeydown"]),c(A,{ref_key:"pwdInput",ref:l,modelValue:i.value.password,"onUpdate:modelValue":s[4]||(s[4]=n=>i.value.password=n),loading:e.value,placeholder:`${a.$t("PleaseInput")} ${a.$t("Password")}`,readonly:e.value,rules:[n=>n&&n.length>0||`${a.$t("PleaseInput")} ${a.$t("Password")}`],type:$.value?"password":"text",dense:"","lazy-rules":"",onKeydown:y(b,["enter"]),onKeyup:s[5]||(s[5]=y(n=>I("PWD"),["enter"]))},{prepend:C(()=>[c(w,{name:"vpn_key"})]),append:C(()=>[c(w,{name:$.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:f},null,8,["name"])]),_:1},8,["modelValue","loading","placeholder","readonly","rules","type","onKeydown"]),j("div",L,[c(K,{modelValue:o.value,"onUpdate:modelValue":s[6]||(s[6]=n=>o.value=n)},{default:C(()=>[S(V(a.$t("RememberMe")),1)]),_:1},8,["modelValue"]),c(N,{label:`${a.$t("Forget")}${a.$t("Password")}`,dense:"",flat:""},null,8,["label"])]),c(N,{loading:e.value,class:"bg-gc-primary text-subtitle2 text-weight-bold",push:"","text-color":"white",onClick:I},{default:C(()=>[S(V(`${a.$t("Login")}${a.$t("System")}`),1)]),_:1},8,["loading"])]),_:1})]))}};export{ee as default};
